# Macros
CXX ?= g++
LDXX ?= g++
LDLIBS ?=
CXXFLAGS ?= -Wall -pedantic -Wextra -g
MKDIR ?= mkdir
RM ?= rm
SOURCE_DIR ?= src
BUILD_DIR ?= build
GAME_NAME ?= textRpg

# Rules
all: $(BUILD_DIR) $(GAME_NAME) doc

# Create directories
$(BUILD_DIR):
	$(MKDIR) -p $(BUILD_DIR)

.PHONY: compile
compile: $(BUILD_DIR) $(GAME_NAME)

.PHONY: run
run: $(BUILD_DIR) $(GAME_NAME)
	./$(GAME_NAME)
# Delete all files generated by compiler
.PHONY: clean
clean:
	$(RM) -r $(BUILD_DIR)
	$(RM) -R doc
	$(RM) $(GAME_NAME)

.PHONY: doc
doc:
	doxygen $(SOURCE_DIR)/Doxyconfig

$(GAME_NAME): $(BUILD_DIR)/main.o $(BUILD_DIR)/game.o $(BUILD_DIR)/map.o $(BUILD_DIR)/character.o
	$(LDXX) $(CXXFLAGS) -o $@ $^ $(LDLIBS)

$(BUILD_DIR)/%.o: $(SOURCE_DIR)/%.c
	$(CXX) $(CXXFLAGS) -c -o $@ $<


# g++ -MM src/*.c >> Makefile
character.o: src/character.c src/character.h
game.o: src/game.c
main.o: src/main.c src/character.h
map.o: src/map.c
